# Backend задание

сделано Олегом Муринским, 29.12.2019

## Папки
1. Transportation - приложение чтения и сортировки билетов
    1. Lib - вспомогательные библиотеки: JsonConverter, Sorter.
    1. Models - модель Ticket, абстрактрый класс Transport и его наследники
    1. Program.cs - основной модуль приложения
    1. tickets.json - файл с несортированными билетами
1. Transportation.Tests - Юнит тесты

## Что сделано

* Выбран формат входных данных вида:
  ```JSON
  [{
    "FromStation": "Station 1",
    "ToStation": "Station 2",
    "TransportType": "Type",
    "Transport": {
      "FlightNumber": "000",
      "GateNumber": "000",
      "SeatNumber": "000",
      "BaggageCounter": "000",
      "BaggageInstructions": ""
    }
  }]
  ```
* Алгоритм работает с любым кол-вом карточек, образующих неразрывную цепочку. В приложение встроена простая защита на случай несостыковки цепочек. В этом случае приложение вернет частично сортированный список.
* Для сортировки карточек использован пузырьковый алгоритм. Для определения очередности сравнивается станция назначения первого билета и станция отправления второго билета. Если станции совпадают, карточки остаются на месте, если не совпадают, карточки меняются местами. За несколько проходов алгоритм выстаивает карточки от превого пунка к последнемую. Первый и последний пункты в результате сортировки обнаруживаются автоматически.
* В приложении два основных типа: Ticker и Transport. Ticket хранит данные о пункте отправиления и назначения и хранит ссылку на тип транспорта. Абстрактный класс Transport объявляет абстрактный метод getInstruction. Наследники объявляют свойства, характерные для данного вида транспорта и определяют способ формирования текстового описания. В приложение добавлены три типа транспорта: Train, Flight, Bus.
* Добавление нового вида транспорта делается по аналогии с классами Train, Flight, Bus. Более никаких изменений в коде не требуется, можно сразу добавлять поездки на новом виде транспорта в файл с билетами.
* Для чтения и генерации JSON файла с билетами сделан кастомный конвертер для класса System.Text.Json.JsonSerializer. Ковертер выгружает тип Transport в отдельное поле и так же при чтении определяет тип транспорта и инициализтирует экземпляр транспорта нужного типа.

## Комментарии к коду
* Изначально я планировал отделить транспорт от билетов интерфейсом, но затем понял, что абстрактного класса достаточно и интерфейс не дает преимущества.
* Изначально класс Ticket был типа Generic и я планировал использовать Generic для сериализации. Идея не сработала, поэтому все Generic я убрал и сделал катомный конвертер для сериализации.
* Newton.JSON и другие готовые библиотеки сериалиазции не использовал принципиально, чтобы приложение не зависило от сторонних компонентов.
* IOC/DI не используется. Решил не усложнять. :)

## Запуск

Перед первым запуском скачать зависимости:
```
cd Backend
dotnet restore
```

Запуск:
```
cd Transportation
dotnet run tickets.json
```

Отображение справки:
```
dotnet run
```

Вывод примера JSON файла
```
dotnet run example
```